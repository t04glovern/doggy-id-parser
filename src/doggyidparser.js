"use strict";

(function(){
    var root = this;
    var prev_doggyidparser = root.doggyidparser;
    var designs = ["0000066666555555555522222222222222222222666666666666666666666666600000.0000066666555555555522222222222222222222666666666666666666666666600000.0000066666555555555522222222222222222222666666666666666666666666600000.0000066666555555555522222222222222222222666666666666666666666666600000.0000066666555555555522222222222222222222666666666666666666666666600000.0000066666111115555566666666662222255555555555555555555666666666600000.0000066666111115555566666666662222255555555555555555555666666666600000.0000066666111115555566666666662222255555555555555555555666666666600000.0000066666111115555566666666662222255555555555555555555666666666600000.0000066666111115555566666666662222255555555555555555555666666666600000.0000066666111115555566666666665555522222222222222222222222222222200000.0000066666111115555566666666665555522222222222222222222222222222200000.0000066666111115555566666666665555522222222222222222222222222222200000.0000066666111115555566666666665555522222222222222222222222222222200000.0000066666111115555566666666665555522222222222222222222222222222200000.0000066666666661111166666666662222222222222222222222222222226666600000.0000066666666661111166666666662222222222222222222222222222226666600000.0000066666666661111166666666662222222222222222222222222222226666600000.0000066666666661111166666666662222222222222222222222222222226666600000.0000066666666661111166666666662222222222222222222222222222226666600000.0000066666666666666666666666662222222222222222222255555555555555500000.0000066666666666666666666666662222222222222222222255555555555555500000.0000066666666666666666666666662222222222222222222255555555555555500000.0000066666666666666666666666662222222222222222222255555555555555500000.0000066666666666666666666666662222222222222222222255555555555555500000.0000066666555556666666666666662222222222222222222255555555556666600000.0000066666555556666666666666662222222222222222222255555555556666600000.0000066666555556666666666666662222222222222222222255555555556666600000.0000066666555556666666666666662222222222222222222255555555556666600000.0000066666555556666666666666662222222222222222222255555555556666600000.0000055555555555555555555555552222222222222222222255555666666666600000.0000055555555555555555555555552222222222222222222255555666666666600000.0000055555555555555555555555552222222222222222222255555666666666600000.0000055555555555555555555555552222222222222222222255555666666666600000.0000055555555555555555555555552222222222222222222255555666666666600000.0000011111111112222222222222222222222222222222222222222555556666600000.0000011111111112222222222222222222222222222222222222222555556666600000.0000011111111112222222222222222222222222222222222222222555556666600000.0000011111111112222222222222222222222222222222222222222555556666600000.0000011111111112222222222222222222222222222222222222222555556666600000.0000066666555552222200000111111111122222222222222222222222222222200000.0000066666555552222200000111111111122222222222222222222222222222200000.0000066666555552222200000111111111122222222222222222222222222222200000.0000066666555552222200000111111111122222222222222222222222222222200000.0000066666555552222200000111111111122222222222222222222222222222200000.0000066666555552222222222111113333344444222222222222222555556666600000.0000066666555552222222222111113333344444222222222222222555556666600000.0000066666555552222222222111113333344444222222222222222555556666600000.0000066666555552222222222111113333344444222222222222222555556666600000.0000066666555552222222222111113333344444222222222222222555556666600000.0000055555555552222222222444443333344444222222222222222555555555500000.0000055555555552222222222444443333344444222222222222222555555555500000.0000055555555552222222222444443333344444222222222222222555555555500000.0000055555555552222222222444443333344444222222222222222555555555500000.0000055555555552222222222444443333344444222222222222222555555555500000.0000011111555552222200000111112222222222222222222255555666666666600000.0000011111555552222200000111112222222222222222222255555666666666600000.0000011111555552222200000111112222222222222222222255555666666666600000.0000011111555552222200000111112222222222222222222255555666666666600000.0000011111555552222200000111112222222222222222222255555666666666600000","0000000000666666666666666666661111133333222224444466666666666666666666666666666666666666666666666666666660000000000.0000000000666666666666666666661111133333222224444466666666666666666666666666666666666666666666666666666660000000000.0000000000666666666666666666661111133333222224444466666666666666666666666666666666666666666666666666666660000000000.0000000000666666666666666666661111133333222224444466666666666666666666666666666666666666666666666666666660000000000.0000000000666666666666666666661111133333222224444466666666666666666666666666666666666666666666666666666660000000000.0000000000666663333333333111115555533333222222222244444666666666666666666666666666666666666666666666666660000000000.0000000000666663333333333111115555533333222222222244444666666666666666666666666666666666666666666666666660000000000.0000000000666663333333333111115555533333222222222244444666666666666666666666666666666666666666666666666660000000000.0000000000666663333333333111115555533333222222222244444666666666666666666666666666666666666666666666666660000000000.0000000000666663333333333111115555533333222222222244444666666666666666666666666666666666666666666666666660000000000.0000000000666666666666666333332222222222222222222244444444446666666666666666666666666666666666666666666660000000000.0000000000666666666666666333332222222222222222222244444444446666666666666666666666666666666666666666666660000000000.0000000000666666666666666333332222222222222222222244444444446666666666666666666666666666666666666666666660000000000.0000000000666666666666666333332222222222222222222244444444446666666666666666666666666666666666666666666660000000000.0000000000666666666666666333332222222222222222222244444444446666666666666666666666666666666666666666666660000000000.0000000000666666666666666666661111111111222222222244444222224444444444666666666666666666666666666666111110000000000.0000000000666666666666666666661111111111222222222244444222224444444444666666666666666666666666666666111110000000000.0000000000666666666666666666661111111111222222222244444222224444444444666666666666666666666666666666111110000000000.0000000000666666666666666666661111111111222222222244444222224444444444666666666666666666666666666666111110000000000.0000000000666666666666666666661111111111222222222244444222224444444444666666666666666666666666666666111110000000000.0000000000333331111111111111111111155555222222222222222222222222222222444443333333333333333333333333666660000000000.0000000000333331111111111111111111155555222222222222222222222222222222444443333333333333333333333333666660000000000.0000000000333331111111111111111111155555222222222222222222222222222222444443333333333333333333333333666660000000000.0000000000333331111111111111111111155555222222222222222222222222222222444443333333333333333333333333666660000000000.0000000000333331111111111111111111155555222222222222222222222222222222444443333333333333333333333333666660000000000.0000000000666663333333333111111111122222222222222255555222222222222222222224444444444444446666666666333330000000000.0000000000666663333333333111111111122222222222222255555222222222222222222224444444444444446666666666333330000000000.0000000000666663333333333111111111122222222222222255555222222222222222222224444444444444446666666666333330000000000.0000000000666663333333333111111111122222222222222255555222222222222222222224444444444444446666666666333330000000000.0000000000666663333333333111111111122222222222222255555222222222222222222224444444444444446666666666333330000000000.0000000000666666666666666333331111111111222225555511111111112222222222222222222233333333335555555555666660000000000.0000000000666666666666666333331111111111222225555511111111112222222222222222222233333333335555555555666660000000000.0000000000666666666666666333331111111111222225555511111111112222222222222222222233333333335555555555666660000000000.0000000000666666666666666333331111111111222225555511111111112222222222222222222233333333335555555555666660000000000.0000000000666666666666666333331111111111222225555511111111112222222222222222222233333333335555555555666660000000000.0000000000666666666666666666666666633333111111111111111111111111111111111112222255555555555555544444666660000000000.0000000000666666666666666666666666633333111111111111111111111111111111111112222255555555555555544444666660000000000.0000000000666666666666666666666666633333111111111111111111111111111111111112222255555555555555544444666660000000000.0000000000666666666666666666666666633333111111111111111111111111111111111112222255555555555555544444666660000000000.0000000000666666666666666666666666633333111111111111111111111111111111111112222255555555555555544444666660000000000.0000000000666666666666666666666666666666333331111111111111111111111111555555555511111111113333333333111110000000000.0000000000666666666666666666666666666666333331111111111111111111111111555555555511111111113333333333111110000000000.0000000000666666666666666666666666666666333331111111111111111111111111555555555511111111113333333333111110000000000.0000000000666666666666666666666666666666333331111111111111111111111111555555555511111111113333333333111110000000000.0000000000666666666666666666666666666666333331111111111111111111111111555555555511111111113333333333111110000000000.0000000000666666666666666666666666666666666663333311111111111111155555111111111111111555555555555555111110000000000.0000000000666666666666666666666666666666666663333311111111111111155555111111111111111555555555555555111110000000000.0000000000666666666666666666666666666666666663333311111111111111155555111111111111111555555555555555111110000000000.0000000000666666666666666666666666666666666663333311111111111111155555111111111111111555555555555555111110000000000.0000000000666666666666666666666666666666666663333311111111111111155555111111111111111555555555555555111110000000000.0000000000666666666666666666666666666666666666666633333333331111111111111111111155555111111111111111555550000000000.0000000000666666666666666666666666666666666666666633333333331111111111111111111155555111111111111111555550000000000.0000000000666666666666666666666666666666666666666633333333331111111111111111111155555111111111111111555550000000000.0000000000666666666666666666666666666666666666666633333333331111111111111111111155555111111111111111555550000000000.0000000000666666666666666666666666666666666666666633333333331111111111111111111155555111111111111111555550000000000.0000000000666666666666666666666666666666666666666666666666663333311111111115555511111111111111111111111110000000000.0000000000666666666666666666666666666666666666666666666666663333311111111115555511111111111111111111111110000000000.0000000000666666666666666666666666666666666666666666666666663333311111111115555511111111111111111111111110000000000.0000000000666666666666666666666666666666666666666666666666663333311111111115555511111111111111111111111110000000000.0000000000666666666666666666666666666666666666666666666666663333311111111115555511111111111111111111111110000000000.0000000000666666666666666666666666666666666666666666666666666666633333111111111111111111111111111111111110000000000.0000000000666666666666666666666666666666666666666666666666666666633333111111111111111111111111111111111110000000000.0000000000666666666666666666666666666666666666666666666666666666633333111111111111111111111111111111111110000000000.0000000000666666666666666666666666666666666666666666666666666666633333111111111111111111111111111111111110000000000.0000000000666666666666666666666666666666666666666666666666666666633333111111111111111111111111111111111110000000000.0000000000666666666666666666666666666666666666666666666666666666666666666663333311111111111111111111111110000000000.0000000000666666666666666666666666666666666666666666666666666666666666666663333311111111111111111111111110000000000.0000000000666666666666666666666666666666666666666666666666666666666666666663333311111111111111111111111110000000000.0000000000666666666666666666666666666666666666666666666666666666666666666663333311111111111111111111111110000000000.0000000000666666666666666666666666666666666666666666666666666666666666666663333311111111111111111111111110000000000.0000000000666666666666666666666666666666666666666666666666666666666666666666666666666333333333333333111110000000000.0000000000666666666666666666666666666666666666666666666666666666666666666666666666666333333333333333111110000000000.0000000000666666666666666666666666666666666666666666666666666666666666666666666666666333333333333333111110000000000.0000000000666666666666666666666666666666666666666666666666666666666666666666666666666333333333333333111110000000000.0000000000666666666666666666666666666666666666666666666666666666666666666666666666666333333333333333111110000000000.0000000000666666666666666666666666666666666666666666666666666666666666666666666666666666666666633333111110000000000.0000000000666666666666666666666666666666666666666666666666666666666666666666666666666666666666633333111110000000000.0000000000666666666666666666666666666666666666666666666666666666666666666666666666666666666666633333111110000000000.0000000000666666666666666666666666666666666666666666666666666666666666666666666666666666666666633333111110000000000.0000000000666666666666666666666666666666666666666666666666666666666666666666666666666666666666633333111110000000000.0000000000666666666666666666666666666666666666666666666666666666666666666666666666666666663333311111333330000000000.0000000000666666666666666666666666666666666666666666666666666666666666666666666666666666663333311111333330000000000.0000000000666666666666666666666666666666666666666666666666666666666666666666666666666666663333311111333330000000000.0000000000666666666666666666666666666666666666666666666666666666666666666666666666666666663333311111333330000000000.0000000000666666666666666666666666666666666666666666666666666666666666666666666666666666663333311111333330000000000.0000000000666666666666666666666666666666666666666666666666666666666666666666666666666333331111122222333330000000000.0000000000666666666666666666666666666666666666666666666666666666666666666666666666666333331111122222333330000000000.0000000000666666666666666666666666666666666666666666666666666666666666666666666666666333331111122222333330000000000.0000000000666666666666666666666666666666666666666666666666666666666666666666666666666333331111122222333330000000000.0000000000666666666666666666666666666666666666666666666666666666666666666666666666666333331111122222333330000000000.0000000000666666666666666666666666666666666666666666666666666666666666666663333333333111112222233333666660000000000.0000000000666666666666666666666666666666666666666666666666666666666666666663333333333111112222233333666660000000000.0000000000666666666666666666666666666666666666666666666666666666666666666663333333333111112222233333666660000000000.0000000000666666666666666666666666666666666666666666666666666666666666666663333333333111112222233333666660000000000.0000000000666666666666666666666666666666666666666666666666666666666666666663333333333111112222233333666660000000000","666666666666666666666666611111111111111111111666666666666666666666666666666666666666666666.666666666666666666666666611111111111111111111666666666666666666666666666666666666666666666.666666666666666666666666611111111111111111111666666666666666666666666666666666666666666666.666666666666666666666666611111111111111111111666666666666666666666666666666666666666666666.666666666666666666666666611111111111111111111666666666666666666666666666666666666666666666.666666666666666666666666666666333333333333333111116666666666666666666611111111111111111111.666666666666666666666666666666333333333333333111116666666666666666666611111111111111111111.666666666666666666666666666666333333333333333111116666666666666666666611111111111111111111.666666666666666666666666666666333333333333333111116666666666666666666611111111111111111111.666666666666666666666666666666333333333333333111116666666666666666666611111111111111111111.666666666666666666666666666666666663333333333111111111111111111111111133333333336666666666.666666666666666666666666666666666663333333333111111111111111111111111133333333336666666666.666666666666666666666666666666666663333333333111111111111111111111111133333333336666666666.666666666666666666666666666666666663333333333111111111111111111111111133333333336666666666.666666666666666666666666666666666663333333333111111111111111111111111133333333336666666666.666666666666666666666666666666666666666611111333333333333333333333333333333333336666666666.666666666666666666666666666666666666666611111333333333333333333333333333333333336666666666.666666666666666666666666666666666666666611111333333333333333333333333333333333336666666666.666666666666666666666666666666666666666611111333333333333333333333333333333333336666666666.666666666666666666666666666666666666666611111333333333333333333333333333333333336666666666.666666666666666666666666666666666666666633333333333333333333333333333333333333331111111111.666666666666666666666666666666666666666633333333333333333333333333333333333333331111111111.666666666666666666666666666666666666666633333333333333333333333333333333333333331111111111.666666666666666666666666666666666666666633333333333333333333333333333333333333331111111111.666666666666666666666666666666666666666633333333333333333333333333333333333333331111111111.666666666666666666666666666666666666666633333333333333333333333331111111111111116666666666.666666666666666666666666666666666666666633333333333333333333333331111111111111116666666666.666666666666666666666666666666666666666633333333333333333333333331111111111111116666666666.666666666666666666666666666666666666666633333333333333333333333331111111111111116666666666.666666666666666666666666666666666666666633333333333333333333333331111111111111116666666666.666666666666666666666666666666666666666633333333333333333333333331111111111111116666666666.666666666666666666666666666666666666666633333333333333333333333331111111111111116666666666.666666666666666666666666666666666666666633333333333333333333333331111111111111116666666666.666666666666666666666666666666666666666633333333333333333333333331111111111111116666666666.666666666666666666666666666666666666666633333333333333333333333331111111111111116666666666.666666666666666666666666611111111111111133333333333333333333333331111166666666666666666666.666666666666666666666666611111111111111133333333333333333333333331111166666666666666666666.666666666666666666666666611111111111111133333333333333333333333331111166666666666666666666.666666666666666666666666611111111111111133333333333333333333333331111166666666666666666666.666666666666666666666666611111111111111133333333333333333333333331111166666666666666666666.666666666666666111111111133333333333333311111333333333333333333331111166666666666666666666.666666666666666111111111133333333333333311111333333333333333333331111166666666666666666666.666666666666666111111111133333333333333311111333333333333333333331111166666666666666666666.666666666666666111111111133333333333333311111333333333333333333331111166666666666666666666.666666666666666111111111133333333333333311111333333333333333333331111166666666666666666666.666661111111111333333333333333333333333333333333333333333333333333333311111666666666666666.666661111111111333333333333333333333333333333333333333333333333333333311111666666666666666.666661111111111333333333333333333333333333333333333333333333333333333311111666666666666666.666661111111111333333333333333333333333333333333333333333333333333333311111666666666666666.666661111111111333333333333333333333333333333333333333333333333333333311111666666666666666.111114444444444333333333333333333334444444444333333333333333333333333333333111116666666666.111114444444444333333333333333333334444444444333333333333333333333333333333111116666666666.111114444444444333333333333333333334444444444333333333333333333333333333333111116666666666.111114444444444333333333333333333334444444444333333333333333333333333333333111116666666666.111114444444444333333333333333333334444444444333333333333333333333333333333111116666666666.666666666633333333335555533333555554444444444444444444444444333333333333333333333333333333.666666666633333333335555533333555554444444444444444444444444333333333333333333333333333333.666666666633333333335555533333555554444444444444444444444444333333333333333333333333333333.666666666633333333335555533333555554444444444444444444444444333333333333333333333333333333.666666666633333333335555533333555554444444444444444444444444333333333333333333333333333333.666666666633333333333333333333444445555544444444444444444444444443333311111666666666666666.666666666633333333333333333333444445555544444444444444444444444443333311111666666666666666.666666666633333333333333333333444445555544444444444444444444444443333311111666666666666666.666666666633333333333333333333444445555544444444444444444444444443333311111666666666666666.666666666633333333333333333333444445555544444444444444444444444443333311111666666666666666.666666666633333333333333344444444445555544444444444444444444444444444411111666666666666666.666666666633333333333333344444444445555544444444444444444444444444444411111666666666666666.666666666633333333333333344444444445555544444444444444444444444444444411111666666666666666.666666666633333333333333344444444445555544444444444444444444444444444411111666666666666666.666666666633333333333333344444444445555544444444444444444444444444444411111666666666666666.666661111133333333333333322222444445555544444444444444444444444441111133333111111111111111.666661111133333333333333322222444445555544444444444444444444444441111133333111111111111111.666661111133333333333333322222444445555544444444444444444444444441111133333111111111111111.666661111133333333333333322222444445555544444444444444444444444441111133333111111111111111.666661111133333333333333322222444445555544444444444444444444444441111133333111111111111111.111114444444444333335555522222222224444444444111111111111111111113333333333333336666666666.111114444444444333335555522222222224444444444111111111111111111113333333333333336666666666.111114444444444333335555522222222224444444444111111111111111111113333333333333336666666666.111114444444444333335555522222222224444444444111111111111111111113333333333333336666666666.111114444444444333335555522222222224444444444111111111111111111113333333333333336666666666.666666666666666333333333322222111115555511111666666666666666666666666666666666666666666666.666666666666666333333333322222111115555511111666666666666666666666666666666666666666666666.666666666666666333333333322222111115555511111666666666666666666666666666666666666666666666.666666666666666333333333322222111115555511111666666666666666666666666666666666666666666666.666666666666666333333333322222111115555511111666666666666666666666666666666666666666666666.666666666666666666666666600000000000000066666666666666666666666666666666666666666666666666.666666666666666666666666600000000000000066666666666666666666666666666666666666666666666666.666666666666666666666666600000000000000066666666666666666666666666666666666666666666666666.666666666666666666666666600000000000000066666666666666666666666666666666666666666666666666.666666666666666666666666600000000000000066666666666666666666666666666666666666666666666666"]
    function RGBToHSL(r, g, b) {
	if (Array.isArray(r)) {
	    g = r[1];
	    b = r[2];
	    r = r[0];
	}
	var r = r / 255;
	var g = g / 255;
	var b = b / 255;
	var cMax = Math.max(r, g, b);
	var cMin = Math.min(r, g, b);
	var delta = cMax - cMin;
	if (delta == 0) {
	    var h = 0;
	} else if (cMax == r) {
	    var h = 60 * (((g - b) / delta) % 6);
	} else if (cMax == g) {
	    var h = 60 * ((b - r) / delta + 2);
	} else if (cMax == b) {
	    var h = 60 * ((r - g) / delta + 4);
	}
	if (h < 0) {
	    h += 360;
	}
	var l = (cMax + cMin) / 2;

	if (delta == 0) {
	    var s = 0;
	} else {
	    var s = delta / (1 - Math.abs(2 * l - 1));
	}

	return [h, s, l]
    }

    function HSLToRGB(h, s, l) {
	if (Array.isArray(h)) {
	    s = h[1];
	    l = h[2];
	    h = h[0];
	}
	var c = (1 - Math.abs(2 * l - 1)) * s;
	var x = c * (1 - Math.abs((h / 60) % 2 - 1));
	var m = l - c / 2;
	if (h >= 0 && h < 60) {
	    var r = c,
		g = x,
		b = 0;
	} else if (h >= 60 && h < 120) {
	    var r = x,
		g = c,
		b = 0;
	} else if (h >= 120 && h < 180) {
	    var r = 0,
		g = c,
		b = x;
	} else if (h >= 180 && h < 240) {
	    var r = 0,
		g = x,
		b = c;
	} else if (h >= 240 && h < 300) {
	    var r = x,
		g = 0,
		b = c;
	} else if (h >= 300 && h < 360) {
	    var r = c,
		g = 0,
		b = x;
	}
	r = Math.round((r + m) * 255);
	g = Math.round((g + m) * 255);
	b = Math.round((b + m) * 255);
	return [r, g, b];
    }

    function RGBToHex(arr) {
	var r = arr[0],
	    g = arr[1],
	    b = arr[2];
	return "#" + ("0" + r.toString(16)).slice(-2) + ("0" + g.toString(16)).slice(-2) + ("0" + b.toString(16)).slice(-2);
    }

    function derivePalette(r, g, b, invert) {
	var hsl = RGBToHSL(r, g, b);

	var h = hsl[0];
	var s = hsl[1];
	var l = hsl[2];
	var hx = h % 360;
	var hy = (h + 320) % 360;

	var c1 = HSLToRGB(hx, 1, 0.1);
	if (invert) {
	    var c4 = HSLToRGB(hx, 1, 0.2);
	    var c5 = HSLToRGB(hx, 1, 0.45);
	    var c2 = HSLToRGB(hx, 1, 0.7);
	    var c3 = HSLToRGB(hy, 1, 0.8);
	} else {
	    var c2 = HSLToRGB(hx, 1, 0.2);
	    var c3 = HSLToRGB(hx, 1, 0.45);
	    var c4 = HSLToRGB(hx, 1, 0.7);
	    var c5 = HSLToRGB(hy, 1, 0.8);

	}

	return [
	    null,
	    RGBToHex(c1),
	    RGBToHex(c2),
	    RGBToHex(c3),
	    RGBToHex(c4),
	    RGBToHex(c5)
	];
    }

    function hexToBytes(hex){
	var result = []
	for(var i = 0; i < hex.length; i+=2){
	    result.push(parseInt(hex.slice(i, i+2),16));
	}
	return result;
    }

    var doggyidparser = function (doggyId){
	if(doggyId.slice(0,2) == "0x"){
	    doggyId = doggyId.slice(2);
	}
	var bytes = hexToBytes(doggyId);
	var genesis = bytes[0],
	    k = bytes[1],
	    r = bytes[2],
	    g = bytes[3],
	    b = bytes[4];

	var size = size || 10;
	var invert = k >= designs.length;
	k = k % designs.length;
	var design = designs[k].split(".");
	var colors;
	if(genesis){
	    if(k % 2 === 0 && invert || k % 2 === 1 && !invert){
		colors = [null, "#555555", "#d3d3d3", "#ffffff", "#aaaaaa", "#ff9999"];
	    }else{
		colors = [null, "#555555", "#222222", "#111111", "#bbbbbb", "#ff9999"];
	    }
	}else{
	    colors = derivePalette(r, g, b, invert);
	}

	return design.map(function(row){
	    return row.split("").map(function(cell){
		return colors[cell];
	    })
	})
    }

    doggyidparser.noConflict = function(){
	root.doggyidparser = prev_doggyidparser;
	return doggyidparser;
    }

    if( typeof exports !== 'undefined' ) {
	if( typeof module !== 'undefined' && module.exports ) {
	    exports = module.exports = doggyidparser;
	}
	exports.doggyidparser = doggyidparser;
    } else {
	root.doggyidparser = doggyidparser;
    }
}).call(this);
